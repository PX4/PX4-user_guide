# Монтаж компаса (або GNSS/компаса)

Модулі компаса та GNSS/компаса слід монтувати на рамі якомога подалі від ліній живлення мотора/ЕЛЕКТРОННИХ ШС і інших джерел електромагнітних перешкод, і [орієнтувати](#compass-orientation) вертикально з напрямним маркером, спрямованим вперед транспортного засобу. Ви також повинні налаштувати PX4, щоб [встановити позицію](#position) приймача відносно центру ваги CoG(ЦМ).

Для багатороторних літаків зазвичай компас монтується на підставці, тоді як для фіксованих крил та VTOL компас зазвичай монтується на крилі.

## Орієнтація компаса

Компас повинен ідеально бути орієнтованим так, щоб він був вертикальним, а напрямний маркер вказував вперед транспортного засобу (типова орієнтація), але за необхідності може бути орієнтований під кутами, кратними 45° від цієї орієнтації (у будь-якій вісі), як це визначено у [стандартних орієнтаціях MAVLink](https://mavlink.io/en/messages/common.html#MAV_SENSOR_ORIENTATION) (вони слідують тій самій конвенції рамки, що і при [орієнтації контролера польоту](../config/flight_controller_orientation.md#calculating-orientation)).

На діаграмі нижче показано напрямний маркер на контролері польоту Pixhawk 4 та компасі.

![Connect compass/GPS to Pixhawk 4](../../assets/flight_controller/pixhawk4/pixhawk4_compass_gps.jpg)

PX4 автоматично визначить орієнтацію для будь-яких з цих стандартних орієнтацій під час [калібрування компаса](../config/compass.md) ([за замовчуванням](../advanced_config/parameter_reference.md#SENS_MAG_AUTOROT)).

Компас також може бути монтуваний в будь-яких інших "власних кутах Ейлера", але в цьому випадку вам доведеться вручну налаштувати орієнтації. Для отримання додаткової інформації див. [Налаштування орієнтації компаса](../config/flight_controller_orientation.md#setting-the-compass-orientation) в _орієнтації контролера польоту/датчика_.

## Положення

Для компенсації відносного руху між приймачем і ЦМ(CoG), ви повинні [налаштувати](../advanced_config/parameters.md) наступні параметри для встановлення зсувів: [EKF2_GPS_POS_X](../advanced_config/parameter_reference.md#EKF2_GPS_POS_X), [EKF2_GPS_POS_Y](../advanced_config/parameter_reference.md#EKF2_GPS_POS_Y) та [EKF2_GPS_POS_Z](../advanced_config/parameter_reference.md#EKF2_GPS_POS_Z).

Це важливо, оскільки кадр тіла, що оцінюється EKF, буде збігатися з місцезнаходженням модуля GNSS та вважатиме його розміщеним на CoG(ЦМ). Якщо модуль GNSS значно відокремлений від CoG(ЦМ), то обертання навколо CoG(ЦМ) буде інтерпретовано як зміна висоти, що у деяких режимах польоту (наприклад, режим позиції) може призвести до непотрібних корекцій.

Це особливо важливо при використанні [RTK GNSS](../advanced/rtk_gps.md), який має точність на рівні сантиметрів, оскільки у разі неналаштування зсувів вимірювання GNSS часто будуть відхилені як несумісні з поточною оцінкою EKF.

::: details
Пояснення Наприклад, якщо модуль GNSS знаходиться на відстані 10 см вище від CoG(ЦМ), а ІМП знаходиться в CoG(ЦМ), рух по тангажу зі швидкістю 1 рад/с створить вимірювання швидкості GNSS в 10 см/с, _навіть якщо ЦМ не рухається_. Якщо точність швидкості приймача GNSS становить 1 см/с, то EKF може перестати довіряти вимірюванням, оскільки вони виглядають невірними (помилкові на 10 разів точніше). Якщо зсуви визначені, EKF скоригує вимірювання, використовуючи дані гіроскопа.
:::
