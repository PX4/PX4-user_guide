# Автопілот CUAV V5 nano

:::warning PX4 не виробляє цей (або будь-який інший) автопілот. Зверніться до [виробника](https://store.cuav.net/) щодо питань технічної підтримки або відповідності вимогам.
:::

**V5 nano**<sup>&reg;</sup> є автопілотом для просторово обмежених застосувань, розробленим CUAV<sup>&reg;</sup>у співпраці з командою PX4.

Автопілот досить малий, щоб використовувати в гоночних дронах розміром 220 мм, але залишається достатньо потужним для більшості використань дрона.

![V5 nano - Hero image](../../assets/flight_controller/cuav_v5_nano/v5_nano_01.png)

:::info V5 nano подібний до [CUAV V5+](../flight_controller/cuav_v5_plus.md), але має форм-фактор все в одному, менше PWM-портів (не може бути використаний для [корпусів](../airframes/airframe_reference.md), які використовують AUX-порти), і не має внутрішнього демпфування.
:::

Деякі з його основних функцій включають:

- Повна сумісність зі стандартом проєкту [Pixhawk](https://pixhawk.org/) **FMUv5** і використовує [Pixhawk Connector Standard](https://pixhawk.org/pixhawk-connector-standard/) для всіх зовнішніх інтерфейсів.
- Більш продуктивний процесор, оперативна пам'ять та флеш-пам'ять, ніж у FMU v3, разом із більш стабільними та надійними датчиками.
- Прошивка сумісна з PX4.
- Велика відстань між контактами вводу/виводу 2,6 мм, що полегшує використання всіх інтерфейсів.

:::info Цей польотний контролер [підтримується виробником](../flight_controller/autopilot_manufacturer_supported.md).
:::

### Короткий опис

Основний процесор FMU: STM32F765◦32 Bit Arm® Cortex®-M7, 216MHz, 2MB пам'яті, 512KB RAM

- Сенсори на платі:

  - Акселератор/гіроскоп: ICM-20689
  - Акселератор/гіроскоп: ICM-20602
  - Акселератор/гіроскоп: BMI055
  - Магнітометр: IST8310
  - Барометр: MS5611

- Інтерфейси: 8 виходів PWM

  - 3 виділених PWM/Capture входи на FMU
  - Виділений R/C вхід для CPPM
  - Виділений вхід R/C для Spektrum / DSM і S.Bus
  - Аналоговий / PWM вхід RSSI
  - 4 загальних послідовних порти
  - 3 I2C порти
  - 4 SPI шини
  - 2 CAN шини
  - Аналогові входи для напруги / струму з батареї
  - 2 додаткових аналогових входи
  - Підтримка nARMED

- Система енергопостачання: вхід Power Brick: 4,75~5,5В
- Вхід USB Power: 4.75~5.25V

- Вага та розміри:
  - Розміри: 60\*40\*14mm
- Інші характеристики:
  - Робоча температура: -20 ~ 85°С (виміряне значення)

## Де купити

[Магазин CUAV](https://store.cuav.net/shop/v5-nano/)

[CUAV Aliexpress](https://www.aliexpress.com/item/33050770314.html?storeId=3257035&spm=2114.12010612.8148356.9.dbe6790bjW2hpH) (міжнародні користувачі)

[CUAV Taobao](https://item.taobao.com/item.htm?spm=a230r.1.14.8.26ab5258veQJRu&id=569404317857&ns=1&abbucket=13#detail) (користувачі з материкового Китаю)

::: info
Автопілот можна придбати з модулем Neo GPS в комплекті
:::

<a id="connection"></a>

## З'єднання (Проводка)

[V5 nano Wiring Quickstart](../assembly/quick_start_cuav_v5_nano.md)

## Схема розташування виводів

Завантажте схему розводки **V5 nano** [звідси](http://manual.cuav.net/V5-Plus.pdf).

## Збірка прошивки

:::tip
Більшості користувачів не потрібно збирати цю прошивку! Вона попередньо зібрана й автоматично встановлюється _QGroundControl_ при підключенні відповідного апаратного забезпечення.
:::

Щоб [зібрати PX4](../dev_setup/building_px4.md) для цієї цілі:

```
make px4_fmu-v5_default
```

<a id="debug_port"></a>

## Відладочний порт

Системна консоль [PX4](../debug/system_console.md) та інтерфейс [SWD](../debug/swd_debug.md) працюють через порт **FMU Debug** (`DSU7`). Плата не має інтерфейсу відладки вводу/виводу.

![Debug port (DSU7)](../../assets/flight_controller/cuav_v5_nano/debug_port_dsu7.jpg)

Відладочний порт (`DSU7`) використовує роз'єм [JST BM06B](https://www.digikey.com.au/product-detail/en/jst-sales-america-inc/BM06B-GHS-TBT-LF-SN-N/455-1582-1-ND/807850) і має наступну розводку:

| Pin     | Сигнал         | Вольт |
| ------- | -------------- | ----- |
| 1 (red) | 5V+            | +5V   |
| 2 (blk) | DEBUG TX (OUT) | +3.3V |
| 3 (blk) | DEBUG RX (IN)  | +3.3V |
| 4 (blk) | FMU_SWDIO      | +3.3V |
| 5 (blk) | FMU_SWCLK      | +3.3V |
| 6 (blk) | GND            | GND   |

До комплекту поставки входить зручний відладочний кабель, який можна під'єднати до порту `DSU7`. Він розділяє кабель FTDI для підключення [PX4 System Console](../debug/system_console.md) до USB-порту комп'ютера і виводи SWD, які використовуються для налагодження SWD/JTAG. Відладочний кабель, що входить до комплекту, не підключається до контакту (1) порту SWD `Vref`.

![CUAV Debug cable](../../assets/flight_controller/cuav_v5_nano/cuav_nano_debug_cable.jpg)

:::warning
Вивід Vref SWD (1) використовує 5В як Vref, але процесор працює при напрузі 3,3В!

Деякі JTAG-адаптери (SEGGER J-Link) використовують напругу Vref для встановлення напруги на лініях SWD. Для прямого підключення до _Segger Jlink_ ми рекомендуємо використовувати 3,3 вольта з контакту 4 роз'єму з позначкою `DSM`/`SBUS`/`RSSI` для забезпечення `Vtref` на JTAG (тобто для забезпечення 3,3 В і _NOT_ 5 В).

За додатковою інформацією звертайтесь до розділу [Використання JTAG для апаратної налагодження](#using-jtag-for-hardware-debugging).
:::

## Зіставлення послідовних портів

| UART   | Пристрій   | Порт                           |
| ------ | ---------- | ------------------------------ |
| UART1  | /dev/ttyS0 | GPS                            |
| USART2 | /dev/ttyS1 | TELEM1 (керування потоком)     |
| USART3 | /dev/ttyS2 | TELEM2 (керування потоком)     |
| UART4  | /dev/ttyS3 | TELEM4                         |
| USART6 | /dev/ttyS4 | TX - RC-вхід з роз'єму SBUS_RC |
| UART7  | /dev/ttyS5 | Debug Console                  |
| UART8  | /dev/ttyS6 | Не підключено (без PX4IO)      |

<!-- Note: Got ports using https://github.com/PX4/PX4-user_guide/pull/672#issuecomment-598198434 -->

## Номінальна напруга

_V5 nano_ повинен живитися від роз'єму `Power` під час польоту, а також може живитися від `USB` для стендового тестування.

::: info Роз'єм `PM2` не може не використовуватися для живлення _V5 nano_ (див. [цей матеріал](#compatibility_pm2)).
:::

::: info Серворейка не живиться від FMU і не забезпечує його живленням. Однак, контакти, позначені **+**, є загальними, і до будь-якого з наборів контактів серводвигуна може бути підключений BEC для живлення рейки живлення серводвигуна.
:::

## Захист від перенапруги

_V5 nano_ не має захисту від перевищення струму.

<a id="Optional-hardware"></a>

## Периферійні пристрої

- [Цифровий датчик швидкості польоту](https://item.taobao.com/item.htm?spm=a1z10.3-c-s.w4002-16371268452.37.6d9f48afsFgGZI&id=9512463037)
- [Телеметричні радіо модулі](https://cuav.taobao.com/category-158480951.htm?spm=2013.1.w5002-16371268426.4.410b7a821qYbBq&search=y&catName=%CA%FD%B4%AB%B5%E7%CC%A8)
- [Далекоміри / Датчики відстані](../sensor/rangefinders.md)

## Підтримувані платформи / планери

Будь-який мультикоптер / літак / наземна платформа / човен, який може керуватися звичайними RC сервоприводами або сервоприводами Futaba S-Bus. Повний набір підтримуваних конфігурацій можна переглянути в розділі [Довідник про планери](../airframes/airframe_reference.md).

## Сумісність

CUAV використовує деякі відмінні дизайни і несумісний з деяким обладнанням, про що буде описано нижче.

<a id="compatibility_gps"></a>

#### Neo v2.0 GPS несумісний з іншими пристроями

Рекомендований для використання з _CUAV V5+_ та _CUAV V5 nano_ _Neo v2.0 GPS_ не є повністю сумісним з іншими контролерами польоту Pixhawk (зокрема, частина дзвіночка несумісна і можуть виникнути проблеми з безпечним перемикачем).

Пристрій прийому GNSS UAVCAN [NEO V2 PRO](http://doc.cuav.net/gps/neo-series-gnss/en/neo-v2-pro.html) також може бути використаний і сумісний з іншими контролерами польоту.

<a id="compatibility_jtag"></a>

#### Використання JTAG для апаратного налагодження

`DSU7` Штифт налагодження FMU 1 має напругу 5 вольтів - не 3,3 вольта від ЦП.

Деякі JTAG-зонди використовують це напругу для встановлення рівнів введення-виведення при спілкуванні з цільовим об'єктом.

Для прямого підключення до _Segger Jlink_ ми рекомендуємо використовувати 3,3 вольти з DSM/SBUS/RSSI пін 4 як Пін 1 на роз'ємі для налагодження (`Vtref`).

<a id="compatibility_pm2"></a>

#### PM2 не може живити модульний політний контролер

`PM2` може вимірювати лише напругу батареї та струм, але **не** живить контролер польоту.

:::warning
PX4 не підтримує цей інтерфейс.
:::

## Відомі проблеми

Проблеми нижче посилаються на _номер партії_, в якій вони вперше з'являються. Номер партії - це чотирицифрова дата виробництва за V01 та відображається на наклейці з боку контролера польоту. Наприклад, серійний номер партії V011904 ((V01 - це номер V5, 1904 - це дата виробництва, тобто номер партії).

<a id="pin1_unfused"></a>

#### Інтерфейс SBUS / DSM / RSSI Pin1 не захищений від перевантаження

:::warning
Це питання безпеки.
:::

Будь ласка, не підключайте інше обладнання (крім RC приймача) до інтерфейсу SBUS / DSM / RSSI - це може призвести до пошкодження обладнання!

- _Знайдено:_ Партії V01190904xxxx
- _Виправлено:_ Партії пізніше, ніж V01190904xxxx

## Додаткова інформація

- [Посібник з V5 nano](http://manual.cuav.net/V5-nano.pdf) (CUAV)
- [Схема роз'ємів для посилання на FMUv5](https://docs.google.com/spreadsheets/d/1-n0__BYDedQrc_2NHqBenG1DNepAgnHpSGglke-QQwY/edit#gid=912976165) (CUAV)
- [CUAV Github](https://github.com/cuav) (CUAV)
- [Журнал збірки конструкції повітряного каркасу за допомогою CUAV v5 nano на рамі DJI FlameWheel450](../frames_multicopter/dji_f450_cuav_5nano.md)
