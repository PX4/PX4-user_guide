# PWM Сервоприводи та Регулятори Швидкості (Контролери Двигуна)

У цьому розділі описано, як підключати та живити контролери безщіткових моторів та сервоприводи на основі ШІМ.

## Огляд підключення ESC

Кожен електронний контролер швидкості (ESC) з широтно-імпульсною модуляцією (PWM) має як мінімум наступні проводи:

- Живлення VBAT (зазвичай товстий і червоний)
- Живлення GND (зазвичай товстий і чорний)

І на штекері серводвигуна:

- Сигнал ШІМ (зазвичай білий або жовтий)
- GND (зазвичай чорний або коричневий)

Роз'єм серводвигуна _може_ також мати провід +5V (зазвичай червоний або помаранчевий). Мета цього дроту та його з'єднання залежить від конкретного ESC та типу транспортного засобу.

:::tip
У деяких випадках (див. нижче) лінія +5V не потрібна.
Замість того, щоб відрізати лінію +5V, ви можете обережно підняти фіксуючу вкладку пластикового корпусу роз'єму серводвигуна для цього контакту (наприклад, використовуючи лезо кабельного ножа або маленький викрутку) і витягнути контакт.
Відокремте його за допомогою ізоляційної електричної стрічки та заклейте його до кабелю сервоприводу.
Це дозволяє вам легко скасувати дріт пізніше, якщо потрібно
:::

## Підключення живлення

Завжди підключайте живлення VBAT та GND до батареї, а сигнал PWM та GND від роз'єму сервоприводу до двигуна.

:::tip
Існує **жодного налаштування**, яке не потребує підключення сигнальної землі!
:::

Підключення до проводу +5V (якщо він є) залежить від ESC/Транспортного засобу.

### Фікосовані крила (літаки) / VTOL

На фіксованому крилі (або VTOL) ESC, лінія +5V зазвичай надає вихід Батарейної Елімінаційної Схеми (BEC).

- Це може бути підключено до шини сервоприводу Pixhawk та використовуватися для живлення сервоприводів для закрилок, елеронів тощо.

  ::: info Небезпечно живити сервоприводи або ESC від джерела живлення авіоніки автопілота. Ось чому пульт керування серії **Pixhawk** не надає живлення для рейки сервоприводу (рейка додаткового сервоприводу не живлена і обмежена до 1A).
:::

- Зазвичай вам слід підключати лише _вихід лише одного BEC_ до шини сервоприводів Pixhawk. (хоча можливо підключити кілька виходів +5V до рейки, це залежить від моделі ESC).

### Мультикоптер

На багатороторному вертольоті, лінія +5V може бути відсутня або (якщо присутня) може бути не підключена.

- Багатороторні літальні апарати часто не потребують сервоприводів, тому не потрібно живити рейку сервоприводу Pixhawk (двигуни зазвичай окремо живляться від розподільної плати живлення).
- Немає шкоди (або користі) в підключенні дроту до рейки сервопривода.
- Регулятори швидкості DJI зазвичай включають цей дріт, але він не підключений.

### Оптоізольований ESC

На ізольованому опто ESC **без** BEC, лінія +5V може потребувати підключення та живлення (для забезпечення живлення мікроконтролеру ESC). У цьому випадку дріт зазвичай буде підключений до рейки серводвигуна контролера польоту, а рейку серводвигуна слід живити від додаткового BEC.

## Конфігурація PX4

Двигуни з ШІМ та сервоприводи налаштовуються за допомогою екрану [Конфігурація приводів](../config/actuators.md) в QGroundControl.

Після призначення виводів та базової калібрування ви можете бажати виконати [калібрування ESC](../advanced_config/esc_calibration.md).

Додаткові параметри конфігурації PWM PX4 можна знайти тут: [Вихідні сигнали PWM](../advanced_config/parameter_reference.md#pwm-outputs).

## Усунення проблем

Pixhawk сумісний з усіма _PWM ESCs_ на ринку. Якщо певний ESC не працює, це означає, що він неправильно підключений або налаштований.

### Контакт із землею

Перевірте, що земля (чорний дріт) роз'єму ESC сервоприводу підключена до Pixhawk (не існує дійсної схеми підключення, яка не має посилання на землю).

:::warning
Небезпечно літати без заземлення. Це тому, що для кожного позитивного імпульсу (сигнал ESC) повинен бути сусідній шлях повернення на землю для чистої форми сигналу.

На зображенні нижче показано, наскільки шумним стає сигнал, якщо не підключено GND.

![PWM without ground](../../assets/hardware/pwm_esc/pwm_without_gnd.png)
:::

### Підключення живлення / Оптозагороджені ESC

Якщо використовується оптоізольований ESC, який не надає BEC / вихідне напруга, будь ласка, переконайтеся, що ESC не потребує живлення для свого +5V лінії для оптоізолятора.

Дивіться перший розділ цієї сторінки пояснює інші важливі моменти щодо підключення живлення.

### Недійсне Мінімальне Значення

Деякі ESC потребують побачити спеціальний низький імпульс перед увімкненням (щоб захистити користувачів, які мають палицю газу в середньому положенні при ввімкненні живлення).

PX4 відсилає імпульс, коли транспортний засіб роззброєний, що приглушує ЕСК при їх роззброєнні та забезпечує правильну ініціалізацію ЕСК. Відповідні значення визначаються та встановлюються як частина процесу [налаштування/тестування приводів](../config/actuators.md#actuator-testing) (внутрішньо ці значення встановлюють параметри для кожного виходу [PWM_MAIN_DISn](../advanced_config/parameter_reference.md#PWM_MAIN_DIS1) та [PWM_AUX_DISn](../advanced_config/parameter_reference.md#PWM_AUX_DIS1)).

### Час очікування

Деякі ШСП можуть вийти з ладу (запобігаючи активацію двигуна), якщо вони не отримали дійсний низький імпульс протягом кількох секунд після ввімкнення живлення.

PX4 відправляє пульс на холостому ході/роззброєному стані одразу після увімкнення живлення, щоб зупинити вийшовший з ладу таймери ESC. Відповідні значення визначаються та встановлюються як частина процесу [налаштування/тестування приводів](../config/actuators.md#actuator-testing) (внутрішньо ці значення встановлюють параметри для кожного виходу [PWM_MAIN_DISn](../advanced_config/parameter_reference.md#PWM_MAIN_DIS1) та [PWM_AUX_DISn](../advanced_config/parameter_reference.md#PWM_AUX_DIS1)).

### Дійсна форма імпульсу, напруга та швидкість оновлення

:::info
Не повинна бути проблемою, але включена для заповнення
:::

Pixhawk використовує активні високі імпульси, які використовуються всіма провідними брендами (Futaba, Spektrum, FrSky).

Інтерфейси ШІМ не мають формальних стандартів, однак звичайні мікроконтролери використовують напругові рівні TTL або CMOS. TTL визначається як низький < 0,8 В та високий > 2,0 В з використанням деяких виробників > 2,4 В для додаткового маржі шуму. Логіка CMOS визначається з подібними рівнями напруги. 5V рівні **ніколи** не потрібні для успішного переходу в _увімкнений_ стан.

:::tip
Futaba, FrSky та Spektrum приймачі видають напругу на рівні 3,3 В або 3,0 В, оскільки вони значно вище 2,4 В.
Pixhawk прийняв цей загальний шаблон промисловості та виводить рівні 3.3V на останніх платах.
:::
