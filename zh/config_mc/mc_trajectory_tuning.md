# 多旋翼设定值调整（轨迹生成器）

本文概述了改变*用户体验*的多旋翼可调整参数：机体对摇杆运动或任务方向变化的反应速度、最大允许速度等。

换言之，本话题解释了如何调整那些影响*期望设定点*的参数，而不是那些影响机体*轨迹跟踪*性能的参数。

生成这些设定点的算法称为“轨迹生成器”。

> **Warning** 本指南适用于高级用户/专家。

<span></span>

> **Tip** 在做任何本文所述的调校*之前*，请先按照[多旋翼 PID 调整指南](../config_mc/pid_tuning_guide_multicopter.md)中的说明进行操作。 请不要试图通过调整这些参数来修复错误的轨迹或抖动。

## 综述

P/PID 控制器的输入是机体尝试跟踪的*期望设定值*。 [PID 调参](../config_mc/pid_tuning_guide_multicopter.md)（“低级调参”）旨在减少期望设定值和机体状态估计值之间的误差。

发送给 P/PID 控制器的*期望设定值*本身是根据摇杆位置（在遥控模式下）或任务指令的*要求设定值*计算的。 要求设定值可能会改变得很快（例如，如果用户“一下子”将摇杆从零移动到最大值）。 如果像“斜坡”信号一样缓慢地调整相应期望设定值，则机体的飞行特性会更好。

*设定值整定*（“较高级整定”）用于指定*要求设定值*和*期望设定值*之间的映射，即用来定义期望设定点到期望设定点间的“斜坡”映射。

> **Tip** P/PID 增益<1>整定不当会导致机体不稳定。 *设定值*整定不当不会导致机体不稳定，但可能会导致产生非常大的加加速度或对设定值变化地响应不灵敏。</p> </blockquote> 
> 
> ## 飞行模式轨迹支持 {#modes}
> 
> [任务模式](../flight_modes/mission.md)始终使用[加加速度限制型](../config_mc/mc_jerk_limited_type_trajectory.md)轨迹。
> 
> [位置模式](../flight_modes/position_mc.md)支持下文列出的所有[轨迹类型](#trajectory_implementation)。 默认情况下使用加加速度限制型轨迹；若要使用其他轨迹类型可以利用 [MPC_POS_MOD](../advanced_config/parameter_reference.md#MPC_POS_MODE) 设置。
> 
> [定高模式](../flight_modes/altitude_mc.md)同样使用 [MPC_POS_MODE](../advanced_config/parameter_reference.md#MPC_POS_MODE) 所指的[轨迹类型](#trajectory_implementation)，但*仅*用于平滑垂直分量（即仅在控制高度时使用）。
> 
> 其他模式不支持轨迹调整。
> 
> ## 轨迹实现 {#trajectory_implementation}
> 
> 下表*概述*了不同类型的轨迹实现：
> 
> - [加加速度限制型](../config_mc/mc_jerk_limited_type_trajectory.md) （默认） 
>   - 当需要平滑运动时使用（例如：航拍、测绘、货运）。
>   - 生成对称平滑 S-曲线，使加加速度和加速度的极限始终得到保证。
>   - 可能不适合于那些需要较快响应的机体/使用案例——例如穿越机。
>   - 通过设置 `MPC_POS_MODE=3` 在位置模式中启用。
> - [旋转速率型](../config_mc/mc_slew_rate_type_trajectory.md) 
>   - 当快速响应比平滑运动更重要时使用（例如：位置保持状态下的激烈飞行)。
>   - 这是一个简单的实现方法，在这种情况下，加加速度和加速度通过旋转速率进行限制。
>   - 它允许基于用户意图的不对称配置（平稳加速和快速停止）。 
>   - 加加速度和加速度限制不是硬性约束。
>   - 通过设置 `MPC_POS_MODE=1` 在位置模式中启用。
> - **简单位置控制** 
>   - 将摇杆直接映射为速度设置值而不进行平滑处理。
>   - 对速度控制调整非常有用。
>   - 通过设置 `MPC_POS_MODE=0` 在位置模式中启用。