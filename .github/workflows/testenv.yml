# Test 2 

name: CI

# Controls when the workflow will run
on:
  pull_request:
    branches: [ main, v1.test_vtol ]

  workflow_dispatch:
  
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      # Get branch name for pull or merge via env file (https://stackoverflow.com/a/64210623/894359)
    
      - name: Get branch name (merge)
        if: github.event_name != 'pull_request'
        shell: bash
        run: echo "BRANCH_NAME=$(echo ${GITHUB_REF#refs/heads/} | tr / -)" >> $GITHUB_ENV
      - name: Get branch name (pull request)
        if: github.event_name == 'pull_request'
        shell: bash
        run: echo "BRANCH_NAME=$(echo ${GITHUB_HEAD_REF} | tr / -)" >> $GITHUB_ENV
        
      - name: Debug
        run: echo DEBUG env.BRANCH_NAME is ${{ env.BRANCH_NAME }} 
  test:  
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      # Get the files that changed. Now we print them.
      # Later we'll pass them into link checker or linter or somethigng
      - id: files
        uses: jitterbit/get-changed-files@v1
      - run: |
         for changed_file in ${{ steps.files.outputs.all }}; do
          echo "Do something with this ${changed_file}."
          done
